{
  "entities": {
    "Customer": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Customer",
      "type": "object",
      "description": "Represents a customer who can book appointments.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the customer."
        },
        "firstName": {
          "type": "string",
          "description": "First name of the customer."
        },
        "lastName": {
          "type": "string",
          "description": "Last name of the customer."
        },
        "email": {
          "type": "string",
          "description": "Email address of the customer.",
          "format": "email"
        },
        "phoneNumber": {
          "type": "string",
          "description": "Phone number of the customer."
        },
        "isAdmin": {
          "type": "boolean",
          "description": "Flag to indicate if the user has administrative privileges. This is managed via Firebase Custom Claims."
        }
      },
      "required": [
        "id",
        "firstName",
        "lastName",
        "email",
        "phoneNumber"
      ]
    },
    "Barber": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Barber",
      "type": "object",
      "description": "Represents a barber providing services.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the barber."
        },
        "firstName": {
          "type": "string",
          "description": "First name of the barber."
        },
        "lastName": {
          "type": "string",
          "description": "Last name of the barber."
        },
        "email": {
          "type": "string",
          "description": "Email address of the barber.",
          "format": "email"
        },
        "phoneNumber": {
          "type": "string",
          "description": "Phone number of the barber."
        },
        "bio": {
          "type": "string",
          "description": "A short biography of the barber."
        }
      },
      "required": [
        "id",
        "firstName",
        "lastName",
        "email",
        "phoneNumber"
      ]
    },
    "Service": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Service",
      "type": "object",
      "description": "Represents a service offered by the barbershop.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the service."
        },
        "name": {
          "type": "string",
          "description": "Name of the service."
        },
        "description": {
          "type": "string",
          "description": "Description of the service."
        },
        "price": {
          "type": "number",
          "description": "Price of the service."
        },
        "duration": {
          "type": "number",
          "description": "Duration of the service in minutes."
        }
      },
      "required": [
        "id",
        "name",
        "description",
        "price",
        "duration"
      ]
    },
    "Appointment": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Appointment",
      "type": "object",
      "description": "Represents an appointment booked by a customer.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the appointment."
        },
        "customerId": {
          "type": "string",
          "description": "Reference to Customer. (Relationship: Customer 1:N Appointment)"
        },
        "barberId": {
          "type": "string",
          "description": "Reference to Barber. (Relationship: Barber 1:N Appointment)"
        },
        "serviceId": {
          "type": "string",
          "description": "Reference to Service. (Relationship: Service 1:N Appointment)"
        },
        "startTime": {
          "type": "string",
          "description": "Start time of the appointment.",
          "format": "date-time"
        },
        "endTime": {
          "type": "string",
          "description": "End time of the appointment.",
          "format": "date-time"
        },
        "status": {
          "type": "string",
          "description": "Status of the appointment (e.g., booked, confirmed, completed, cancelled)."
        }
      },
      "required": [
        "id",
        "customerId",
        "barberId",
        "serviceId",
        "startTime",
        "endTime",
        "status"
      ]
    },
    "Schedule": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Schedule",
      "type": "object",
      "description": "Represents the availability schedule of a barber.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the schedule."
        },
        "barberId": {
          "type": "string",
          "description": "Reference to Barber. (Relationship: Barber 1:N Schedule)"
        },
        "dayOfWeek": {
          "type": "string",
          "description": "Day of the week for the schedule (e.g., Monday, Tuesday)."
        },
        "startTime": {
          "type": "string",
          "description": "Start time of the barber's availability on that day."
        },
        "endTime": {
          "type": "string",
          "description": "End time of the barber's availability on that day."
        }
      },
      "required": [
        "id",
        "barberId",
        "dayOfWeek",
        "startTime",
        "endTime"
      ]
    },
    "ShopSetting": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Shop Setting",
      "type": "object",
      "description": "Represents a global setting for the shop, like working hours.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the setting."
        },
        "startTime": {
          "type": "string",
          "description": "The default start time for shop operations."
        },
        "endTime": {
          "type": "string",
          "description": "The default end time for shop operations."
        }
      },
      "required": ["id", "startTime", "endTime"]
    },
    "PageContent": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Page Content",
      "type": "object",
      "description": "Represents editable content for a specific page.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the page content (e.g., 'home')."
        },
        "shopName": {
            "type": "string",
            "description": "The name of the shop, displayed in the header."
        },
        "heroHeadline": {
          "type": "string",
          "description": "Main headline in the hero section."
        },
        "heroSubheadline": {
          "type": "string",
          "description": "Subheadline or paragraph in the hero section."
        },
        "feature1Title": {
          "type": "string"
        },
        "feature1Description": {
          "type": "string"
        },
        "feature2Title": {
          "type": "string"
        },
        "feature2Description": {
          "type": "string"
        },
        "feature3Title": {
          "type": "string"
        },
        "feature3Description": {
          "type": "string"
        },
        "servicesTitle": {
          "type": "string"
        },
        "barbersTitle": {
          "type": "string"
        }
      },
      "required": [
        "id",
        "shopName",
        "heroHeadline",
        "heroSubheadline"
      ]
    }
  },
  "auth": {
    "providers": [
      "password",
      "anonymous",
      "line"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "/customers/{customerId}",
        "definition": {
          "entityName": "Customer",
          "schema": {
            "$ref": "#/backend/entities/Customer"
          },
          "description": "Stores customer profiles. Customers can only read/write their own profile unless the user is an admin.",
          "params": [
            {
              "name": "customerId",
              "description": "The unique identifier of the customer (same as the Firebase auth UID)."
            }
          ]
        }
      },
      {
        "path": "/barbers/{barberId}",
        "definition": {
          "entityName": "Barber",
          "schema": {
            "$ref": "#/backend/entities/Barber"
          },
          "description": "Stores barber profiles. Publicly readable. Only admins can create/update/delete.",
          "params": [
            {
              "name": "barberId",
              "description": "The unique identifier of the barber."
            }
          ]
        }
      },
      {
        "path": "/services/{serviceId}",
        "definition": {
          "entityName": "Service",
          "schema": {
            "$ref": "#/backend/entities/Service"
          },
          "description": "Stores service information. Publicly readable. Only admins can create/update/delete.",
          "params": [
            {
              "name": "serviceId",
              "description": "The unique identifier of the service."
            }
          ]
        }
      },
      {
        "path": "/appointments/{appointmentId}",
        "definition": {
          "entityName": "Appointment",
          "schema": {
            "$ref": "#/backend/entities/Appointment"
          },
          "description": "Stores appointments booked by customers. Customers can only manage their own appointments. Admins can manage all appointments.",
          "params": [
            {
              "name": "appointmentId",
              "description": "The unique identifier of the appointment."
            }
          ]
        }
      },
      {
        "path": "/schedules/{scheduleId}",
        "definition": {
          "entityName": "Schedule",
          "schema": {
            "$ref": "#/backend/entities/Schedule"
          },
          "description": "Stores the availability schedules of barbers. Publicly readable. Only admins or the assigned barber can create/update/delete.",
          "params": [
            {
              "name": "scheduleId",
              "description": "The unique identifier of the schedule."
            }
          ]
        }
      },
      {
        "path": "/shopSettings/{settingId}",
        "definition": {
          "entityName": "ShopSetting",
          "schema": {
            "$ref": "#/backend/entities/ShopSetting"
          },
          "description": "Stores global shop settings. We expect a single document with a known ID (e.g., 'hours').",
          "params": [
            {
              "name": "settingId",
              "description": "The unique identifier for the setting document."
            }
          ]
        }
      },
      {
        "path": "/pageContent/{pageId}",
        "definition": {
          "entityName": "PageContent",
          "schema": {
            "$ref": "#/backend/entities/PageContent"
          },
          "description": "Stores editable text content for site pages. Publicly readable, admin-only write.",
          "params": [
            {
              "name": "pageId",
              "description": "The unique identifier for the page (e.g., 'home')."
            }
          ]
        }
      }
    ],
    "reasoning": "The Firestore structure is designed to support the SnipQueue application, focusing on appointment booking and barber management. All major data types (customers, barbers, services, appointments, schedules) are stored in top-level collections. This flat structure simplifies queries and security rules. \n\n- Customers (`/customers/{customerId}`): Stores user profiles. Rules ensure users can only access their own data.\n- Barbers (`/barbers/{barberId}`): Publicly readable barber profiles, writable only by admins or the barbers themselves.\n- Services (`/services/{serviceId}`): Publicly readable service information, managed by admins.\n- Schedules (`/schedules/{scheduleId}`): Barber availability, linked via a `barberId`. Publicly readable, but only writable by the assigned barber or an admin.\n- Appointments (`/appointments/{appointmentId}`): All appointments are in a single collection. This is efficient for admin-level queries (e.g., daily timeline, reports). Security rules are crucial here to ensure users can only query/access their own appointments, while barbers can see their assigned appointments and admins can see all. Rules are based on the `customerId` and `barberId` fields within the appointment document.\n- Shop Settings (`/shopSettings/{settingId}`): Stores global configuration like open hours. Publicly readable so the client can use it, but only writable by admins."
  }
}
